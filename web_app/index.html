<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Aplicação para caminhamento de rede elétrica - Coleta de dados no campo">
    <meta name="theme-color" content="#1e3a8a">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>

    <script src="https://unpkg.com/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script>

    <title>Caminhamento de Rede - Coleta de Dados</title>

    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/matriz.css">
    <link rel="stylesheet" href="css/caminhamento.css">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body>
    <header>
        <div id="header-container">
            <h1 id="header-logo">Caminhamento de Rede</h1>
        </div>
    </header>
    <main>
        <h1 id="project-title">Coleta de Dados - Caminhamento</h1>
        
        <div id="project-infos">
            <label>
                Nome do cliente:
                <input type="text" id="customer-name">
            </label>
            <label>
                Número do projeto do cliente:
                <input type="number" id="customer-project-number">
            </label>
            <label>
                Empresa do projeto:
                <input type="text" id="project-company">
            </label>
            <label>
                Município:
                <input type="text" id="municipality">
            </label>
            <label>
                Telefone do cliente:
                <input type="text" id="customer-number">
            </label>
        </div>

        <div id="files-interaction">
            <input type="file" id="kml-upload" accept=".kml,.kmz" style="display: none;"/>
            <button id="btn-upload">Importar KML</button>
            <button id="btn-export-kml">Exportar KML</button>
            <button id="btn-export-csv">Gerar CSV</button>
            <button id="btn-add-poste">Adicionar Poste</button>
        </div>

        <div id="line-map-container">
            <h2 class="caption">Mapa da linha</h2>
            <div id="line-map"></div>
        </div>

        <!-- Lista de Postes (Sidebar Mobile) -->
        <div id="postes-sidebar" class="sidebar-mobile">
            <div class="sidebar-header">
                <h2>Postes Cadastrados</h2>
                <button id="btn-close-sidebar" class="btn-close-sidebar">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="sidebar-content">
                <div id="postes-list" class="postes-list">
                    <p class="empty-message">Nenhum poste cadastrado ainda.</p>
                </div>
            </div>
        </div>

        <!-- Modal: Formulário de Poste -->
        <div id="modal-poste" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modal-title">Adicionar Poste</h2>
                    <button class="btn-close-modal" id="btn-close-modal">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="form-poste">
                        <input type="hidden" id="poste-lat" name="poste-lat">
                        <input type="hidden" id="poste-lon" name="poste-lon">
                        <input type="hidden" id="poste-sequencia" name="poste-sequencia">

                        <!-- Tabs para múltiplos status -->
                        <div class="status-tabs">
                            <button type="button" class="status-tab active" data-status="Implantar">
                                Implantar
                            </button>
                            <button type="button" class="status-tab" data-status="Existente">
                                Existente
                            </button>
                            <button type="button" class="status-tab" data-status="Retirar">
                                Retirar
                            </button>
                            <button type="button" class="status-tab" data-status="deslocar">
                                Deslocar
                            </button>
                        </div>

                        <!-- Conteúdo dos tabs -->
                        <div class="status-content" id="status-content">
                            <!-- Tab Implantar -->
                            <div class="status-panel active" data-status="Implantar">
                                <div class="form-group">
                                    <label for="tipo_poste_implantar">Tipo de Poste</label>
                                    <input type="text" id="tipo_poste_implantar" name="tipo_poste_implantar" placeholder="Ex: N3, DT10/300">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv1_implantar">Estrutura MT NV1</label>
                                    <input type="text" id="estru_mt_nv1_implantar" name="estru_mt_nv1_implantar" placeholder="Ex: N3, UP1">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv2_implantar">Estrutura MT NV2</label>
                                    <input type="text" id="estru_mt_nv2_implantar" name="estru_mt_nv2_implantar">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv3_implantar">Estrutura MT NV3</label>
                                    <input type="text" id="estru_mt_nv3_implantar" name="estru_mt_nv3_implantar">
                                </div>
                                <div class="form-group">
                                    <label for="est_bt_nv1_implantar">Estrutura BT NV1</label>
                                    <input type="text" id="est_bt_nv1_implantar" name="est_bt_nv1_implantar" placeholder="Ex: A1">
                                </div>
                                <div class="form-group">
                                    <label for="est_bt_nv2_implantar">Estrutura BT NV2</label>
                                    <input type="text" id="est_bt_nv2_implantar" name="est_bt_nv2_implantar">
                                </div>
                                <div class="form-group">
                                    <label for="rotacao_poste_implantar">Rotação Poste</label>
                                    <input type="text" id="rotacao_poste_implantar" name="rotacao_poste_implantar" placeholder="Ex: topo1">
                                </div>
                                <div class="form-group">
                                    <label for="modulo_implantar">Módulo</label>
                                    <input type="text" id="modulo_implantar" name="modulo_implantar" placeholder="Ex: mt7">
                                </div>
                                <div class="form-group">
                                    <label for="municipio_implantar">Município</label>
                                    <input type="text" id="municipio_implantar" name="municipio_implantar" placeholder="Ex: Goiania">
                                </div>
                            </div>

                            <!-- Tab Existente -->
                            <div class="status-panel" data-status="Existente">
                                <div class="form-group">
                                    <label for="num_poste_existente">Número do Poste</label>
                                    <input type="text" id="num_poste_existente" name="num_poste_existente" placeholder="Ex: 46464546">
                                </div>
                                <div class="form-group">
                                    <label for="tipo_poste_existente">Tipo de Poste</label>
                                    <input type="text" id="tipo_poste_existente" name="tipo_poste_existente" placeholder="Ex: DT10/300">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv1_existente">Estrutura MT NV1</label>
                                    <input type="text" id="estru_mt_nv1_existente" name="estru_mt_nv1_existente" placeholder="Ex: N1">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv2_existente">Estrutura MT NV2</label>
                                    <input type="text" id="estru_mt_nv2_existente" name="estru_mt_nv2_existente">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv3_existente">Estrutura MT NV3</label>
                                    <input type="text" id="estru_mt_nv3_existente" name="estru_mt_nv3_existente">
                                </div>
                            </div>

                            <!-- Tab Retirar -->
                            <div class="status-panel" data-status="Retirar">
                                <div class="form-group">
                                    <label for="tipo_poste_retirar">Tipo de Poste</label>
                                    <input type="text" id="tipo_poste_retirar" name="tipo_poste_retirar">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv1_retirar">Estrutura MT NV1</label>
                                    <input type="text" id="estru_mt_nv1_retirar" name="estru_mt_nv1_retirar" placeholder="Ex: UP1">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv2_retirar">Estrutura MT NV2</label>
                                    <input type="text" id="estru_mt_nv2_retirar" name="estru_mt_nv2_retirar">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv3_retirar">Estrutura MT NV3</label>
                                    <input type="text" id="estru_mt_nv3_retirar" name="estru_mt_nv3_retirar">
                                </div>
                            </div>

                            <!-- Tab Deslocar -->
                            <div class="status-panel" data-status="deslocar">
                                <div class="form-group">
                                    <label for="tipo_poste_deslocar">Tipo de Poste</label>
                                    <input type="text" id="tipo_poste_deslocar" name="tipo_poste_deslocar">
                                </div>
                                <div class="form-group">
                                    <label for="estru_mt_nv1_deslocar">Estrutura MT NV1</label>
                                    <input type="text" id="estru_mt_nv1_deslocar" name="estru_mt_nv1_deslocar">
                                </div>
                                <div class="form-group">
                                    <label for="base_reforcada_deslocar">Base Reforçada</label>
                                    <input type="text" id="base_reforcada_deslocar" name="base_reforcada_deslocar">
                                </div>
                                <div class="form-group">
                                    <label for="base_concreto_deslocar">Base Concreto</label>
                                    <input type="text" id="base_concreto_deslocar" name="base_concreto_deslocar" placeholder="Ex: BC">
                                </div>
                                <div class="form-group">
                                    <label for="estai_ancora_deslocar">Estai Âncora</label>
                                    <input type="text" id="estai_ancora_deslocar" name="estai_ancora_deslocar" placeholder="Ex: 1EA">
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="button" id="btn-cancel-poste">Cancelar</button>
                            <button type="submit" class="button">Salvar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Floating Action Button (Mobile) -->
        <button id="btn-menu-fab" class="fab-menu">
            <i class="bi bi-list"></i>
        </button>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    
    <!-- Custom Scripts -->
    <script src="js/map.js"></script>
    <script src="js/kml-handler.js"></script>
    <script src="js/csv-generator.js"></script>
    <script src="js/form-handler.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
